/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

// CURRENT ENVIROMENT VARIABLES
export const ENVIRONMENT_DEFAULT = 'local_dev';
export const EDITOR_MODE_DEFAULT = 'solo_rich';
export const E2E_TABLE_MODE_DEFAULT = 'table_modern';
export const EVENTS_MODE_DEFAULT = 'events_modern';

// Base variables for configuration composition
export const BROWSERS = {
  CHROMIUM: 'chromium',
  FIREFOX: 'firefox',
  WEBKIT: 'webkit',
};

export const EDITOR_MODES = {
  COLLAB_RICH: 'collab_rich',
  SOLO_PLAIN: 'solo_plain',
  SOLO_RICH: 'solo_rich',
};

export const EVENTS_MODES = {
  LEGACY: 'events_legacy',
  MODERN: 'events_modern',
};

const ENVIRONMENT_CI_DEV = 'ci_dev';
const ENVIRONMENT_CI_PROD = 'ci_prod';
const ENVIRONMENT_LOCAL_DEV = 'local_dev';

export const ENVIRONMENTS = {
  CI_DEV: ENVIRONMENT_CI_DEV,
  CI_PROD: ENVIRONMENT_CI_PROD,
  LOCAL_DEV: ENVIRONMENT_LOCAL_DEV,
};

/** NOTE: we should reduce this to at most 2 ports, one for dev, one for CI, or just one port if possible */
export const PORTS = {
  [ENVIRONMENT_CI_DEV]: '4000',
  [ENVIRONMENT_CI_PROD]: '4173',
  [ENVIRONMENT_LOCAL_DEV]: '3000',
};

/** Likely deprecated, not used anywhere except defaulting to modern */
export const TABLE_MODES = {
  LEGACY: 'table_legacy',
  MODERN: 'table_modern',
};

export const TEST_PROFILE_01_C_SR_M_LD = `${BROWSERS.CHROMIUM}-${EDITOR_MODES.SOLO_RICH}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_02_C_SP_M_LD = `${BROWSERS.CHROMIUM}-${EDITOR_MODES.SOLO_PLAIN}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_03_C_CR_M_LD = `${BROWSERS.CHROMIUM}-${EDITOR_MODES.COLLAB_RICH}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_04_W_SR_M_LD = `${BROWSERS.WEBKIT}-${EDITOR_MODES.SOLO_RICH}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_05_W_SP_M_LD = `${BROWSERS.WEBKIT}-${EDITOR_MODES.SOLO_PLAIN}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_06_W_CR_M_LD = `${BROWSERS.WEBKIT}-${EDITOR_MODES.COLLAB_RICH}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_07_F_SR_M_LD = `${BROWSERS.FIREFOX}-${EDITOR_MODES.SOLO_RICH}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_08_F_SP_M_LD = `${BROWSERS.FIREFOX}-${EDITOR_MODES.SOLO_PLAIN}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_09_F_CR_M_LD = `${BROWSERS.FIREFOX}-${EDITOR_MODES.COLLAB_RICH}-${EVENTS_MODES.MODERN}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_10_C_SR_L_LD = `${BROWSERS.CHROMIUM}-${EDITOR_MODES.SOLO_RICH}-${EVENTS_MODES.LEGACY}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_11_C_CR_L_LD = `${BROWSERS.CHROMIUM}-${EDITOR_MODES.COLLAB_RICH}-${EVENTS_MODES.LEGACY}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_12_W_SR_L_LD = `${BROWSERS.WEBKIT}-${EDITOR_MODES.SOLO_RICH}-${EVENTS_MODES.LEGACY}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_13_W_CR_L_LD = `${BROWSERS.WEBKIT}-${EDITOR_MODES.COLLAB_RICH}-${EVENTS_MODES.LEGACY}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_14_F_SR_L_LD = `${BROWSERS.FIREFOX}-${EDITOR_MODES.SOLO_RICH}-${EVENTS_MODES.LEGACY}-${ENVIRONMENTS.LOCAL_DEV}`;
export const TEST_PROFILE_15_F_CR_L_LD = `${BROWSERS.FIREFOX}-${EDITOR_MODES.COLLAB_RICH}-${EVENTS_MODES.LEGACY}-${ENVIRONMENTS.LOCAL_DEV}`;

const TEST_PROFILES = {
  /** @typedef {{ EDITOR_MODE: string, EVENTS_MODE: string, ENVIRONMENT: typeof ENVIRONMENTS.LOCAL_DEV }} TestProfile */
  [TEST_PROFILE_01_C_SR_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_02_C_SP_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_PLAIN,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_03_C_CR_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.COLLAB_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_04_W_SR_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_05_W_SP_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_PLAIN,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_06_W_CR_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.COLLAB_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_07_F_SR_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_08_F_SP_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_PLAIN,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_09_F_CR_M_LD]: {
    EDITOR_MODE: EDITOR_MODES.COLLAB_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.MODERN,
  },
  [TEST_PROFILE_10_C_SR_L_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.LEGACY,
  },
  [TEST_PROFILE_11_C_CR_L_LD]: {
    EDITOR_MODE: EDITOR_MODES.COLLAB_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.LEGACY,
  },
  [TEST_PROFILE_12_W_SR_L_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.LEGACY,
  },
  [TEST_PROFILE_13_W_CR_L_LD]: {
    EDITOR_MODE: EDITOR_MODES.COLLAB_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.LEGACY,
  },
  [TEST_PROFILE_14_F_SR_L_LD]: {
    EDITOR_MODE: EDITOR_MODES.SOLO_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.LEGACY,
  },
  [TEST_PROFILE_15_F_CR_L_LD]: {
    EDITOR_MODE: EDITOR_MODES.COLLAB_RICH,
    ENVIRONMENT: ENVIRONMENTS.LOCAL_DEV,
    EVENTS_MODE: EVENTS_MODES.LEGACY,
  },
};

/**
 * @param {keyof typeof TEST_PROFILES} testProfileName
 * @returns {{
 *   isCollab: boolean,
 *   isPlainText: boolean,
 *   isRichText: boolean,
 *   legacyEvents: boolean,
 *   environment: typeof ENVIRONMENTS.LOCAL_DEV | typeof ENVIRONMENTS.CI_DEV | typeof ENVIRONMENTS.CI_PROD,
 *   tableHorizontalScroll: boolean,
 * }}
 */
export function getTestProfile(testProfileName) {
  return {
    environment: TEST_PROFILES[testProfileName].ENVIRONMENT,
    isCollab: TEST_PROFILES[testProfileName].EDITOR_MODE === 'collab_rich',
    isPlainText: TEST_PROFILES[testProfileName].EDITOR_MODE === 'solo_plain',
    isRichText:
      TEST_PROFILES[testProfileName].EDITOR_MODE === 'solo_rich' ||
      TEST_PROFILES[testProfileName].EDITOR_MODE === 'collab_rich',
    legacyEvents:
      TEST_PROFILES[testProfileName].EVENTS_MODE === 'events_legacy',
    tableHorizontalScroll:
      TEST_PROFILES[testProfileName].TABLE_MODE !== 'table_legacy',
  };
}
